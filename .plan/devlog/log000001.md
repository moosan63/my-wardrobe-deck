# Dev Log 000001 - Phase 0: 環境セットアップ

## 対象フェーズ
Phase 0: 環境セットアップ

## 実施内容の要約

HonoX + Cloudflare Workers + D1 + Tailwind CSS の開発環境を構築した。

### 作成したファイル

**設定ファイル**
- `package.json` - npm パッケージ管理
- `tsconfig.json` - TypeScript設定
- `vite.config.ts` - Viteビルド設定（クライアント/サーバー両対応）
- `vitest.config.ts` - Cloudflare Workers pool を使用したVitest設定
- `wrangler.toml` - Cloudflare Workers / D1設定
- `tailwind.config.js` - Tailwind CSS設定（カスタムカラーパレット含む）
- `postcss.config.js` - PostCSS設定

**アプリケーションファイル**
- `app/server.ts` - HonoXサーバーエントリーポイント
- `app/client.ts` - クライアントサイドエントリーポイント
- `app/routes/_renderer.tsx` - HTMLレンダラー（Font Awesome、Noto Sans JP読み込み）
- `app/routes/index.tsx` - ホームページ
- `app/global.d.ts` - グローバル型定義（D1Database等）
- `app/static/style.css` - Tailwind CSSエントリーポイント

**ディレクトリ構造**
- `app/routes/` - ルーティング
- `app/components/items/` - アイテム関連コンポーネント
- `app/components/layout/` - レイアウトコンポーネント
- `app/components/ui/` - UIコンポーネント
- `app/db/` - D1アクセス層
- `app/middleware/` - ミドルウェア
- `app/lib/` - ユーティリティ・定数
- `app/types/` - 型定義
- `tests/` - テスト
- `migrations/` - D1マイグレーション

**テストファイル**
- `tests/setup.test.ts` - Vitest動作確認用サンプルテスト

## 技術的判断・理由

### 1. vite.config.ts のmode分岐
クライアントビルドとサーバービルドを分離するため、`mode === 'client'` で分岐する設計を採用。
これにより、Tailwind CSSがクライアントビルド時に正しく処理され、`dist/static/style.css` に出力される。

### 2. wrangler.toml の compatibility_flags
`@cloudflare/vitest-pool-workers` を使用するには `nodejs_compat` フラグが必須。
初期設定で不足していたため追加した。

### 3. HonoX の Link コンポーネント使用
`_renderer.tsx` でCSSを読み込む際、`honox/server` の `Link` コンポーネントを使用。
これにより、ビルド時にViteがCSSをバンドルし、適切なパスに出力する。

### 4. カスタムカラーパレット
SPECIFICATION.md に記載された hotel-uro.jp 参考のカラーパレットを `tailwind.config.js` に設定：
- Primary: #2D3748（ダークグレー）
- Secondary: #718096（ミディアムグレー）
- Accent: #C4A35A（ゴールド/ベージュ）
- Background: #F7FAFC（ライトグレー）
- Card Background: #FFFFFF
- Text: #1A202C

## レビュー内容と対応
（本フェーズはレビュー前の初期セットアップのため該当なし）

## 問題点・反省

### wrangler バージョン警告
`npm install` 時に `wrangler@3.100.0` が非推奨という警告が出た。
現時点では動作に影響なしと判断し、後続フェーズで必要に応じて対応する。

### Vite警告
開発サーバー起動時に `Could not auto-determine entry point` の警告が出るが、
HonoXの仕様上、この警告は無視して問題ない。

## 次フェーズへの申し送り

- Phase 1 では `migrations/0001_create_items.sql` を作成し、D1マイグレーションを実行する
- 型定義（`app/types/item.ts`）は Item, CreateItemInput, UpdateItemInput を定義予定
- DBアクセス層（`app/db/items.ts`）はTDDで実装する
- テストは `tests/db/items.test.ts` に配置

## 完了条件の確認

| 条件 | 結果 |
|------|------|
| `npm run dev` でローカルサーバー起動 | OK |
| `npm run test` でテスト実行可能 | OK (2テストパス) |
| Tailwind CSSが適用される | OK (ビルド時にCSSが出力される) |
